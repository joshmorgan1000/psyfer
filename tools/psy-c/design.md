# The `psy-c` Tool

## Overview

The `psy-c` tool is a command-line utility much like the compilers that come with Cap'n Proto or Protocol Buffers (see `third_part/capnproto` if you need some example code). It is designed to generate C++23 code for serialization and deserialization of data structures, but just a bit different.

## New Features

The C++ file(s) generated by `psy-c` won't just serialize and deserialize, but they will also encrypt or decrypt the data as well. Compressio/decompression will be an option but not as important.

A few details:

- I think our schema and code generated can probably be simpler since we're not actually sending these across the wire?
- We will need to add our own annotations for the schema to indicate which fields (or the whole structure) should be encrypted and with what algorithm (HMAC? HMAC_SHA? AES256? ChaCha20? etc.) - all depending on where the annotation is defined in the schema.
- When objects are instantiated, they will exist in memory as unencrypted. Once the "encrypt" method is called, the user should have the option to specify a pointer or span to the memory where the encrypted data should be written. This means there needs to be a method for the user to get the size of what the serialized data will be encrypted, so they know how much memory to allocate. If not specified, `psy-c` will allocate the memory for them.
- Users must pass the encrypt and decrypt methods a `SecureKey` instance. No key management will be done by `psy-c`.
- All the generated code should only depend on the `psyfer.hpp` header file, but other than that require no other dependencies.
- This should be our own implementation/interpretation of the Cap'n Proto or Protocol Buffers design, so we can do whatever we want with it (preferably simplifying it wherever possible).
